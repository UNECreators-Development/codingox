<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Codingox | Running Queries</title>
  <!-- <link rel="shortcut icon" href="" /> -->
  <link rel="stylesheet" href="../assets/css/webtheme.css" type="text/css" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
</head>

<body class="wy-body-for-nav" role="document">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> Codingox</a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul>
          <li class="toctree-l1"><a class="reference internal" href="../general/welcome.html">Welcome to Codingox</a>
          </li>
          <li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation
              Instructions</a>
          </li>
          <li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Codingox Overview</a>
          </li>
          <li class="toctree-l1"><a class="reference internal" href="../general/index.html">General Topics</a>
          </li>
        </ul>
        <ul class="current">
          <li class="toctree-l1 current"><a class="reference internal" href="index.html">Database</a>
            <ul class="current">
              <li class="toctree-l2"><a class="reference internal" href="examples.html">Quick Start</a>
              </li>
              <li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration</a>
              </li>
              <li class="toctree-l2"><a class="reference internal" href="connecting.html">Database Connection</a>
              </li>
              <li class="toctree-l2 current"><a class="current reference internal" href="javascript:void(0)">Running
                  Queries</a></li>
              <li class="toctree-l2"><a class="reference internal" href="results.html">Query Results</a></li>
              <li class="toctree-l2"><a class="reference internal" href="query_builder.html">Query Builder Class</a>
              </li>
            </ul>
          </li>
        </ul>
        <ul>
          <li class="toctree-l1"><a class="reference internal" href="../libraries/index.html">Libraries</a>
          </li>
          <li class="toctree-l1"><a class="reference internal" href="../helpers/index.html">Helpers</a>
          </li>
        </ul>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Codingox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ul class="wy-breadcrumbs">
              <li><a href="../index.html">Docs</a>&raquo;</li>

              <li><a href="index.html">Database Reference</a>&raquo;</li>

              <li>Queries</li>
            </ul>
            <hr />
          </div>
          <div role="main" class="document">

            <div class="section" id="queries">
              <div class="section" id="query-basics">
                <h2>Queries<a class="headerlink" href="#queries" title="Permalink to this headline">¶</a></h2>
                <div class="section" id="regular-queries">
                  <p>To submit a query, use the <strong>query</strong> function:</p>
                  <div class="highlight-ci">
                    <div class="highlight">
                      <pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;YOUR QUERY HERE&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span></pre>
                    </div>
                  </div>
                  <p>The query() function returns a database result <strong>object</strong> when “read”
                    type queries are run, which you can use to <a class="reference internal" href="results.html"><span
                        class="doc">show your
                        results</span></a>. When “write” type queries are run it simply
                    returns TRUE or FALSE depending on success or failure. When retrieving
                    data you will typically assign the query to your own variable, like
                    this:</p>
                  <div class="highlight-ci">
                    <div class="highlight">
                      <pre><span></span><span class="nv">$query</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;YOUR QUERY HERE&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span></pre>
                    </div>
                  </div>
                </div>
              </div>
              <div class="section" id="working-with-database-prefixes-manually">
                <h2>Working with Database prefixes manually<a class="headerlink"
                    href="#working-with-database-prefixes-manually" title="Permalink to this headline">¶</a></h2>
                <p>If you have configured a database prefix and would like to prepend it to
                  a table name for use in a native SQL query for example, then you can use
                  the following:</p>
                <div class="highlight-ci">
                  <div class="highlight">
                    <pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">prefix</span><span class="p">(</span><span class="s1">&#39;tablename&#39;</span><span class="p">);</span> <span class="c1">// outputs prefix_tablename</span></pre>
                  </div>
                </div>
                <p>If for any reason you would like to change the prefix programatically
                  without needing to create a new connection, you can use this method:</p>
                <div class="highlight-ci">
                  <div class="highlight">
                    <pre><span></span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">set_prefix</span><span class="p">(</span><span class="s1">&#39;newprefix_&#39;</span><span class="p">);</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">prefix</span><span class="p">(</span><span class="s1">&#39;tablename&#39;</span><span class="p">);</span> <span class="c1">// outputs newprefix_tablename</span>
</pre>
                  </div>
                </div>
              </div>
              
              <div class="section" id="escaping-queries">
                <h2>Escaping Queries<a class="headerlink" href="#escaping-queries"
                    title="Permalink to this headline">¶</a></h2>
                <p>It’s a very good security practice to escape your data before submitting
                  it into your database. Codingox has three methods that help you do
                  this:</p>
                <ol class="arabic">
                  <li>
                    <p class="first"><strong>$this-&gt;db-&gt;escape()</strong> This function determines the data type
                      so
                      that it can escape only string data. It also automatically adds
                      single quotes around the data so you don’t have to:</p>
                    <div class="highlight-ci">
                      <div class="highlight">
                        <pre><span></span><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO table (title) VALUES(&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">escape</span><span class="p">(</span><span class="nv">$title</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;)&quot;</span><span class="p">;</span></pre>
                      </div>
                    </div>
                  </li>
                  <li>
                    <p class="first"><strong>$this-&gt;db-&gt;escape_str()</strong> This function escapes the data
                      passed to
                      it, regardless of type. Most of the time you’ll use the above
                      function rather than this one. Use the function like this:</p>
                    <div class="highlight-ci">
                      <div class="highlight">
                        <pre><span></span><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO table (title) VALUES(&#39;&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">escape_str</span><span class="p">(</span><span class="nv">$title</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;)&quot;</span><span class="p">;</span></pre>
                      </div>
                    </div>
                  </li>
                  <li>
                    <p class="first"><strong>$this-&gt;db-&gt;escape_like_str()</strong> This method should be used when
                      strings are to be used in LIKE conditions so that LIKE wildcards
                      (‘%’, ‘_’) in the string are also properly escaped.</p>
                  </li>
                </ol>
                <div class="highlight-ci">
                  <div class="highlight">
                    <pre><span></span><span class="nv">$search</span> <span class="o">=</span> <span class="s1">&#39;20% raise&#39;</span><span class="p">;</span>
<span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT id FROM table WHERE column LIKE &#39;%&quot;</span> <span class="o">.</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">escape_like_str</span><span class="p">(</span><span class="nv">$search</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;%&#39; ESCAPE &#39;!&#39;&quot;</span><span class="p">;</span>
</pre>
                  </div>
                </div>
                <div class="admonition important">
                  <p class="first admonition-title">Important</p>
                  <p class="last">The <code class="docutils literal"><span class="pre">escape_like_str()</span></code>
                    method uses ‘!’ (exclamation mark)
                    to escape special characters for <em>LIKE</em> conditions. Because this
                    method escapes partial strings that you would wrap in quotes
                    yourself, it cannot automatically add the <code
                      class="docutils literal"><span class="pre">ESCAPE</span> <span class="pre">'!'</span></code>
                    condition for you, and so you’ll have to manually do that.</p>
                </div>
              </div>
              <div class="section" id="query-bindings">
                <h2>Query Bindings<a class="headerlink" href="#query-bindings" title="Permalink to this headline">¶</a>
                </h2>
                <p>Bindings enable you to simplify your query syntax by letting the system
                  put the queries together for you. Consider the following example:</p>
                <div class="highlight-ci">
                  <div class="highlight">
                    <pre><span></span><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM some_table WHERE id = ? AND status = ? AND author = ?&quot;</span><span class="p">;</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;live&#39;</span><span class="p">,</span> <span class="s1">&#39;Rick&#39;</span><span class="p">));</span>
</pre>
                  </div>
                </div>
                <p>The question marks in the query are automatically replaced with the
                  values in the array in the second parameter of the query function.</p>
                <p>Binding also work with arrays, which will be transformed to IN sets:</p>
                <div class="highlight-ci">
                  <div class="highlight">
                    <pre><span></span><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM some_table WHERE id IN ? AND status = ? AND author = ?&quot;</span><span class="p">;</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;live&#39;</span><span class="p">,</span> <span class="s1">&#39;Rick&#39;</span><span class="p">));</span>
</pre>
                  </div>
                </div>
                <p>The resulting query will be:</p>
                <div class="highlight-ci">
                  <div class="highlight">
                    <pre><span></span><span class="nx">SELECT</span> <span class="o">*</span> <span class="nx">FROM</span> <span class="nx">some_table</span> <span class="nx">WHERE</span> <span class="nx">id</span> <span class="nx">IN</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="k">AND</span> <span class="nx">status</span> <span class="o">=</span> <span class="s1">&#39;live&#39;</span> <span class="k">AND</span> <span class="nx">author</span> <span class="o">=</span> <span class="s1">&#39;Rick&#39;</span>
</pre>
                  </div>
                </div>
                <p>The secondary benefit of using binds is that the values are
                  automatically escaped, producing safer queries. You don’t have to
                  remember to manually escape data; the engine does it automatically for
                  you.</p>
              </div>
            </div>
          </div>

          <footer>
            <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
              <a href="results.html" class="btn btn-neutral float-right" title="Generating Query Results">Next <span
                  class="fa fa-arrow-circle-right"></span></a>

              <a href="connecting.html" class="btn btn-neutral" title="Connecting to your Database"><span
                  class="fa fa-arrow-circle-left"></span> Previous</a>
            </div>
            <hr />

            <div role="contentinfo">
              <p>&copy; Copyright 2020 Codingox.</p>
            </div>
          </footer>
        </div>
      </div>
    </section>
  </div>

  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: './',
      VERSION: '1.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: false
    };
  </script>

  <script type="text/javascript" src="../assets/jquery.js"></script>
  <script type="text/javascript" src="../assets/underscore.js"></script>
  <script type="text/javascript" src="../assets/doctools.js"></script>
  <script type="text/javascript" src="../assets/js/theme.js"></script>

  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });
  </script>

</body>

</html>